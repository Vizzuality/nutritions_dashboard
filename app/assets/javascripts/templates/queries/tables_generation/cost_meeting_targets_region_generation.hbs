{{!-- This query was used to generate cost_meeting_targets_region table from targets_by_year table --}}

WITH region as (select sum_of_package, package, target, country, region 
FROM targets_aggregate 
WHERE scenario='Business As Usual' and sum_of_package is not null and package='Full'), 

total_targets as (SELECT sum_of_package, package, target, country, region 
from region) 

SELECT sum(sum_of_package), package, target, region 
FROM total_targets 
GROUP BY package, target, region 
ORDER BY region, target asc
